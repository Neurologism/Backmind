{
  "name": "Improving the performance of a neural network",
  "summary": "",
  "description": "",
  "visibility": "public",
  "requiredTutorials": ["Training on Wine Quality Dataset"],
  "nextTutorials": ["How Reliable Is Your Model?"],
  "experienceGain": 100,
  "startProject": {
    "nodes": [
      {
        "id": "0.c9agnbfq327",
        "type": "wine_quality",
        "initialized": false,
        "position": {
          "x": 1424,
          "y": 460
        },
        "data": {
          "batch_size": 32
        },
        "identifier": "dataset_wine_quality",
        "group_identifier": "dataset"
      },
      {
        "id": "0.nkcq9um7v77",
        "type": "input_layer",
        "initialized": false,
        "position": {
          "x": 1320,
          "y": 204
        },
        "data": {
          "batch_size": null,
          "dtype": "float32",
          "sparse": false,
          "optional": false
        },
        "identifier": "input",
        "group_identifier": "layer"
      },
      {
        "id": "0.am1l3dlgt77",
        "type": "dense",
        "initialized": false,
        "position": {
          "x": 1317,
          "y": 292
        },
        "data": {
          "activation": "tanh",
          "use_bias": true,
          "lora_rank": null,
          "units": 32
        },
        "identifier": "dense",
        "group_identifier": "layer"
      },
      {
        "id": "0.p4ub0g4qll6",
        "type": "dense",
        "initialized": false,
        "position": {
          "x": 1317,
          "y": 383
        },
        "data": {
          "activation": "linear",
          "use_bias": true,
          "lora_rank": null,
          "units": 1
        },
        "identifier": "dense",
        "group_identifier": "layer"
      },
      {
        "id": "0.nahx3v1j47",
        "type": "Model",
        "initialized": false,
        "position": {
          "x": 1159,
          "y": 196
        },
        "data": {
          "optimizer": "rmsprop",
          "loss": "mean_squared_error",
          "metrics": ["mean_absolute_error"],
          "name": "model"
        },
        "identifier": "Model",
        "group_identifier": "model"
      },
      {
        "id": "0.ul4abqqi87",
        "type": "fit",
        "initialized": false,
        "position": {
          "x": 1122,
          "y": 546
        },
        "data": {
          "epochs": 1,
          "early_stopping": null,
          "name": "model"
        },
        "identifier": "fit",
        "group_identifier": "model"
      }
    ],
    "edges": [
      {
        "id": "vueflow__edge-0.nkcq9um7v77out-0.nkcq9um7v77-0.am1l3dlgt77in-0.am1l3dlgt77",
        "type": "smoothstep",
        "source": "0.nkcq9um7v77",
        "target": "0.am1l3dlgt77",
        "sourceHandle": "out-0.nkcq9um7v77",
        "targetHandle": "in-0.am1l3dlgt77",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1378.316650390625,
        "sourceY": 254,
        "targetX": 1378.8333129882812,
        "targetY": 286
      },
      {
        "id": "vueflow__edge-0.am1l3dlgt77out-0.am1l3dlgt77-0.p4ub0g4qll6in-0.p4ub0g4qll6",
        "type": "smoothstep",
        "source": "0.am1l3dlgt77",
        "target": "0.p4ub0g4qll6",
        "sourceHandle": "out-0.am1l3dlgt77",
        "targetHandle": "in-0.p4ub0g4qll6",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1378.8333129882812,
        "sourceY": 342,
        "targetX": 1378.8333129882812,
        "targetY": 377
      },
      {
        "id": "vueflow__edge-0.nahx3v1j47val-input-0.nahx3v1j47-0.nkcq9um7v77in-0.nkcq9um7v77",
        "type": "smoothstep",
        "source": "0.nahx3v1j47",
        "target": "0.nkcq9um7v77",
        "sourceHandle": "val-input-0.nahx3v1j47",
        "targetHandle": "in-0.nkcq9um7v77",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1247.3999938964844,
        "sourceY": 254,
        "targetX": 1378.316650390625,
        "targetY": 198
      },
      {
        "id": "vueflow__edge-0.p4ub0g4qll6out-0.p4ub0g4qll6-0.nahx3v1j47val-output-0.nahx3v1j47",
        "type": "smoothstep",
        "source": "0.p4ub0g4qll6",
        "target": "0.nahx3v1j47",
        "sourceHandle": "out-0.p4ub0g4qll6",
        "targetHandle": "val-output-0.nahx3v1j47",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1378.8333129882812,
        "sourceY": 433,
        "targetX": 1247.3999938964844,
        "targetY": 294
      },
      {
        "id": "vueflow__edge-0.nahx3v1j47out-0.nahx3v1j47-0.ul4abqqi87in-0.ul4abqqi87",
        "type": "smoothstep",
        "source": "0.nahx3v1j47",
        "target": "0.ul4abqqi87",
        "sourceHandle": "out-0.nahx3v1j47",
        "targetHandle": "in-0.ul4abqqi87",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "teal",
          "strokeWidth": 2
        },
        "sourceX": 1201.2000122070312,
        "sourceY": 326,
        "targetX": 1202,
        "targetY": 540
      },
      {
        "id": "vueflow__edge-0.c9agnbfq327val-train-0.c9agnbfq327-0.ul4abqqi87val-data-0.ul4abqqi87",
        "type": "smoothstep",
        "source": "0.c9agnbfq327",
        "target": "0.ul4abqqi87",
        "sourceHandle": "val-train-0.c9agnbfq327",
        "targetHandle": "val-data-0.ul4abqqi87",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "#ff5722",
          "strokeWidth": 2
        },
        "sourceX": 1556.5,
        "sourceY": 518,
        "targetX": 1286,
        "targetY": 604
      }
    ],
    "position": [-904, 55],
    "zoom": 1,
    "viewport": {
      "x": -904,
      "y": 55,
      "zoom": 1
    }
  },
  "unlockNodes": [],
  "steps": [
    {
      "text": "GPT! GPT! GPT! Generative Pretrained Transformer! ............. We'll talk more about this exciting topic in the future, I promise! For now, let's focus on optimizing your model, shall we?",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "To help your model learn faster and more effectively, let’s add a normalization layer. Disconnect the Input layer from the first Dense layer, and instead, connect the Input layer to a Normalization layer.",
      "narrator": "LeNet-5",
      "addNodes": [
        {
          "id": "0.8h6rp4fo12q",
          "data": {
            "axis": -1,
            "invert": false
          },
          "identifier": "normalization",
          "group_identifier": "layer"
        }
      ],
      "addEdges": [
        {
          "id": "vueflow__edge-0.nkcq9um7v77out-0.nkcq9um7v77-0.8h6rp4fo12qin-0.8h6rp4fo12q",
          "source": "0.nkcq9um7v77",
          "target": "0.8h6rp4fo12q",
          "sourceHandle": "out-0.nkcq9um7v77",
          "targetHandle": "in-0.8h6rp4fo12q"
        }
      ],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [
        {
          "id": "vueflow__edge-0.nkcq9um7v77out-0.nkcq9um7v77-0.am1l3dlgt77in-0.am1l3dlgt77"
        }
      ],
      "highlightNodeTypes": ["normalization"],
      "unlockNodes": []
    },
    {
      "text": "Let’s increase your model’s capacity by adding more Dense layers. First, add a Dense layer with 1024 units. Then, add another Dense layer with 512 units. These layers will give your model more power to learn complex patterns.",
      "narrator": "LeNet-5",
      "addNodes": [
        {
          "id": "0.1v5q1v5q1v5",
          "identifier": "dense",
          "group_identifier": "layer"
        },
        {
          "id": "0.1v5q1v5q1v6",
          "identifier": "dense",
          "group_identifier": "layer"
        }
      ],
      "addEdges": [],
      "modifyNodes": [
        {
          "id": "0.1v5q1v5q1v5",
          "data": {
            "units": 1024
          }
        },
        {
          "id": "0.1v5q1v5q1v6",
          "data": {
            "units": 512
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": ["dense"],
      "unlockNodes": []
    },
    {
      "text": "For both of the new Dense layers, select the Tanh activation function. ",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [
        {
          "id": "0.1v5q1v5q1v5",
          "data": {
            "activation": "tanh"
          }
        },
        {
          "id": "0.1v5q1v5q1v6",
          "data": {
            "activation": "tanh"
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Now, let’s structure the model as follows: Input -> Normalization -> Dense (1024 units) -> Dense (512 units) -> Dense (32 units) -> Output(1 unit). Take a moment to set this up.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [
        {
          "id": "vueflow__edge-0.8h6rp4fo12qout-0.8h6rp4fo12q-0.1v5q1v5q1v5in-0.1v5q1v5q1v5",
          "type": "smoothstep",
          "source": "0.8h6rp4fo12q",
          "target": "0.1v5q1v5q1v5",
          "sourceHandle": "out-0.8h6rp4fo12q",
          "targetHandle": "in-0.1v5q1v5q1v5"
        },
        {
          "id": "vueflow__edge-0.1v5q1v5q1v5out-0.1v5q1v5q1v5-0.1v5q1v5q1v6in-0.1v5q1v5q1v6",
          "type": "smoothstep",
          "source": "0.1v5q1v5q1v5",
          "target": "0.1v5q1v5q1v6",
          "sourceHandle": "out-0.1v5q1v5q1v5",
          "targetHandle": "in-0.1v5q1v5q1v6"
        },
        {
          "id": "vueflow__edge-0.1v5q1v5q1v6out-0.1v5q1v5q1v6-0.am1l3dlgt77in-0.am1l3dlgt77",
          "type": "smoothstep",
          "source": "0.1v5q1v5q1v6",
          "target": "0.am1l3dlgt77",
          "sourceHandle": "out-0.1v5q1v5q1v6",
          "targetHandle": "in-0.am1l3dlgt77"
        }
      ],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "All set? Hit the Train button and let’s see how your model performs with these changes.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": [],
      "trainingEnabled": true
    },
    {
      "text": "Amazing work! Your model’s performance has improved significantly. Previously, the Mean Absolute Error (MAE) was around 4.5, but now it’s down to 2.5. Great progress!",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "We can do even better. In Tutorial 5, we discussed how the number of epochs can affect performance. Let’s increase the number of epochs to 100. You can set this in the Fit node.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [
        {
          "id": "0.ul4abqqi87",
          "data": {
            "epochs": 100
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Add a Line Chart node to monitor your progress. Set the y label to MAE and connect it to the Fit node. Now, hit Train and observe the model’s performance.",
      "narrator": "LeNet-5",
      "addNodes": [
        {
          "id": "0.1x1z1z1z1z1",
          "type": "line-chart",
          "identifier": "line-chart",
          "group_identifier": "visualizer"
        }
      ],
      "addEdges": [
        {
          "id": "vueflow__edge-0.ul4abqqi87val-visualizers-0.ul4abqqi87-0.1x1z1z1z1z1in-0.1x1z1z1z1z1",
          "type": "smoothstep",
          "source": "0.ul4abqqi87",
          "target": "0.1x1z1z1z1z1",
          "sourceHandle": "val-visualizers-0.ul4abqqi87",
          "targetHandle": "in-0.1x1z1z1z1z1"
        }
      ],
      "modifyNodes": [
        {
          "id": "0.1x1z1z1z1z1",
          "data": {
            "y_label": "mae"
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": [],
      "trainingEnabled": true
    },
    {
      "text": "Wow! Your model’s MAE is now down to 0.2. That’s a huge improvement! However, you might have noticed that training took a bit longer this time. This is a trade-off when increasing the number of epochs.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "There’s a simple trick to reduce training time: increase the batch size. Remember our example with the maze and advisors? The batch size is like the number of advisors you consult before making each move. Let’s set the batch size to 128 in the Wine Quality dataset and train the model again.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [
        {
          "id": "0.c9agnbfq327",
          "data": {
            "batch_size": 128
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": [],
      "trainingEnabled": true
    },
    {
      "text": "Good news! Training time was significantly reduced. The MAE increased slightly to around 0.3, but that’s still a strong performance. Why does this happen?",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Think of it this way: One epoch means consulting all advisors (data) once. With a larger batch size, you consult fewer groups of advisors but get more precise feedback per group. Smaller batch sizes mean more frequent feedback but less precise per update. ",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Choosing the right batch size depends on your dataset and model complexity. Experimentation is key to finding the optimal value.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Fantastic work! You’ve learned how to add layers to increase model capacity, adjust the number of epochs for better performance, and optimize training time by modifying the batch size. Keep experimenting, and keep improving. Great job!",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "modifyNodes": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    }
  ]
}
