{
  "name": "Validation and Early Stopping",
  "summary": "",
  "description": "",
  "visibility": "public",
  "requiredTutorials": ["How Reliable Is Your Model?"],
  "nextTutorials": [],
  "experienceGain": 100,
  "startProject": {
    "nodes": [
      {
        "id": "0.c9agnbfq324",
        "type": "wine_quality",
        "initialized": false,
        "position": {
          "x": 1444.4202342842545,
          "y": 689.9963229910772
        },
        "data": {
          "batch_size": 32
        },
        "identifier": "dataset_wine_quality",
        "group_identifier": "dataset"
      },
      {
        "id": "0.nkcq9um7v74",
        "type": "input_layer",
        "initialized": false,
        "position": {
          "x": 1309.752508271445,
          "y": 115.6413037643924
        },
        "data": {
          "batch_size": null,
          "dtype": "float32",
          "sparse": false,
          "optional": false
        },
        "identifier": "input",
        "group_identifier": "layer"
      },
      {
        "id": "0.am1l3dlgt74",
        "type": "dense",
        "initialized": false,
        "position": {
          "x": 1305.1777590985896,
          "y": 442.46488419977015
        },
        "data": {
          "activation": "tanh",
          "use_bias": true,
          "lora_rank": null,
          "units": 32
        },
        "identifier": "dense",
        "group_identifier": "layer"
      },
      {
        "id": "0.p4ub0g4qll4",
        "type": "dense",
        "initialized": false,
        "position": {
          "x": 1305.1777590985896,
          "y": 521.6426432983599
        },
        "data": {
          "activation": "linear",
          "use_bias": true,
          "lora_rank": null,
          "units": 1
        },
        "identifier": "dense",
        "group_identifier": "layer"
      },
      {
        "id": "0.nahx3v1644",
        "type": "Model",
        "initialized": false,
        "position": {
          "x": 1152.551504962867,
          "y": 274.4566896184516
        },
        "data": {
          "optimizer": "rmsprop",
          "loss": "mean_squared_error",
          "metrics": ["mean_absolute_error"],
          "name": "model"
        },
        "identifier": "Model",
        "group_identifier": "model"
      },
      {
        "id": "0.nahx3v1j44",
        "type": "fit",
        "initialized": false,
        "position": {
          "x": 1114.4767557900116,
          "y": 757.7255870525338
        },
        "data": {
          "epochs": 100,
          "early_stopping": null,
          "name": "model"
        },
        "identifier": "fit",
        "group_identifier": "model"
      },
      {
        "id": "0.8h6rp4fo124",
        "type": "normalization",
        "initialized": false,
        "position": {
          "x": 1278.5319377618014,
          "y": 202.13127067861248
        },
        "data": {
          "axis": -1,
          "invert": false
        },
        "identifier": "normalization",
        "group_identifier": "layer"
      },
      {
        "id": "0.1v5q1v5q1v4",
        "type": "dense",
        "initialized": false,
        "position": {
          "x": 1306.4754162560444,
          "y": 281.6627094699196
        },
        "data": {
          "activation": "tanh",
          "use_bias": true,
          "lora_rank": null,
          "units": 1024
        },
        "identifier": "dense",
        "group_identifier": "layer"
      },
      {
        "id": "0.1v5q1v5q146",
        "type": "dense",
        "initialized": false,
        "position": {
          "x": 1305.4006670831886,
          "y": 361.1941482612267
        },
        "data": {
          "activation": "tanh",
          "use_bias": true,
          "lora_rank": null,
          "units": 512
        },
        "identifier": "dense",
        "group_identifier": "layer"
      },
      {
        "id": "0.1x1z1z1z1z4",
        "type": "line-chart",
        "initialized": false,
        "position": {
          "x": 1621.3769239027058,
          "y": 658.8996691422008
        },
        "data": {
          "x_label": "epoch",
          "y_label": "mean_absolute_error"
        },
        "identifier": "line-chart",
        "group_identifier": "visualizer",
        "height": 300,
        "width": 450
      },
      {
        "id": "0.vjnimptoz",
        "type": "split",
        "initialized": false,
        "position": {
          "x": 1453.7160529372477,
          "y": 831.9342859719363
        },
        "data": {
          "ratio": 0.8
        },
        "identifier": "split",
        "group_identifier": "dataset"
      },
      {
        "id": "0.8h6rp4foe24",
        "type": "evaluate",
        "initialized": false,
        "position": {
          "x": 1145.263040327719,
          "y": 955.5304408503189
        },
        "data": {
          "name": "model"
        },
        "identifier": "evaluate",
        "group_identifier": "model"
      }
    ],
    "edges": [
      {
        "id": "vueflow__edge-0.am1l3dlgt74out-0.am1l3dlgt74-0.p4ub0g4qll4in-0.p4ub0g4qll4",
        "type": "smoothstep",
        "source": "0.am1l3dlgt74",
        "target": "0.p4ub0g4qll4",
        "sourceHandle": "out-0.am1l3dlgt74",
        "targetHandle": "in-0.p4ub0g4qll4",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1367.0110110517146,
        "sourceY": 492.46488419977015,
        "targetX": 1367.0110110517146,
        "targetY": 515.6426432983599
      },
      {
        "id": "vueflow__edge-0.nahx3v1644val-input-0.nahx3v1644-0.nkcq9um7v74in-0.nkcq9um7v74",
        "type": "smoothstep",
        "source": "0.nahx3v1644",
        "target": "0.nkcq9um7v74",
        "sourceHandle": "val-input-0.nahx3v1644",
        "targetHandle": "in-0.nkcq9um7v74",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1240.951407306617,
        "sourceY": 332.4566896184516,
        "targetX": 1368.06915866207,
        "targetY": 109.6413037643924
      },
      {
        "id": "vueflow__edge-0.p4ub0g4qll4out-0.p4ub0g4qll4-0.nahx3v1644val-output-0.nahx3v1644",
        "type": "smoothstep",
        "source": "0.p4ub0g4qll4",
        "target": "0.nahx3v1644",
        "sourceHandle": "out-0.p4ub0g4qll4",
        "targetHandle": "val-output-0.nahx3v1644",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1367.0110110517146,
        "sourceY": 571.6426432983599,
        "targetX": 1240.951407306617,
        "targetY": 372.4566896184516
      },
      {
        "id": "vueflow__edge-0.nahx3v1644out-0.nahx3v1644-0.nahx3v1j44in-0.nahx3v1j44",
        "type": "smoothstep",
        "source": "0.nahx3v1644",
        "target": "0.nahx3v1j44",
        "sourceHandle": "out-0.nahx3v1644",
        "targetHandle": "in-0.nahx3v1j44",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "teal",
          "strokeWidth": 2
        },
        "sourceX": 1194.751456134742,
        "sourceY": 404.4566896184516,
        "targetX": 1194.4767557900116,
        "targetY": 751.7255870525338
      },
      {
        "id": "vueflow__edge-0.nkcq9um7v74out-0.nkcq9um7v74-0.8h6rp4fo124in-0.8h6rp4fo124",
        "type": "smoothstep",
        "source": "0.nkcq9um7v74",
        "target": "0.8h6rp4fo124",
        "sourceHandle": "out-0.nkcq9um7v74",
        "targetHandle": "in-0.8h6rp4fo124",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1368.06915866207,
        "sourceY": 165.6413037643924,
        "targetX": 1368.4152385430514,
        "targetY": 196.13127067861248
      },
      {
        "id": "vueflow__edge-0.8h6rp4fo124out-0.8h6rp4fo124-0.1v5q1v5q1v4in-0.1v5q1v5q1v4",
        "type": "smoothstep",
        "source": "0.8h6rp4fo124",
        "target": "0.1v5q1v5q1v4",
        "sourceHandle": "out-0.8h6rp4fo124",
        "targetHandle": "in-0.1v5q1v5q1v4",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1368.4152385430514,
        "sourceY": 252.13127067861248,
        "targetX": 1368.3086682091694,
        "targetY": 275.6627094699196
      },
      {
        "id": "vueflow__edge-0.1v5q1v5q1v4out-0.1v5q1v5q1v4-0.1v5q1v5q146in-0.1v5q1v5q146",
        "type": "smoothstep",
        "source": "0.1v5q1v5q1v4",
        "target": "0.1v5q1v5q146",
        "sourceHandle": "out-0.1v5q1v5q1v4",
        "targetHandle": "in-0.1v5q1v5q146",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1368.3086682091694,
        "sourceY": 331.6627094699196,
        "targetX": 1367.2340411066261,
        "targetY": 355.1941482612267
      },
      {
        "id": "vueflow__edge-0.1v5q1v5q146out-0.1v5q1v5q146-0.am1l3dlgt74in-0.am1l3dlgt74",
        "type": "smoothstep",
        "source": "0.1v5q1v5q146",
        "target": "0.am1l3dlgt74",
        "sourceHandle": "out-0.1v5q1v5q146",
        "targetHandle": "in-0.am1l3dlgt74",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "green",
          "strokeWidth": 2
        },
        "sourceX": 1367.2340411066261,
        "sourceY": 411.1941482612267,
        "targetX": 1367.0110110517146,
        "targetY": 436.46488419977015
      },
      {
        "id": "vueflow__edge-0.nahx3v1j44val-visualizers-0.nahx3v1j44-0.1x1z1z1z1z4in-0.1x1z1z1z1z4",
        "type": "smoothstep",
        "source": "0.nahx3v1j44",
        "target": "0.1x1z1z1z1z4",
        "sourceHandle": "val-visualizers-0.nahx3v1j44",
        "targetHandle": "in-0.1x1z1z1z1z4",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "purple",
          "strokeWidth": 2
        },
        "sourceX": 1278.4767557900116,
        "sourceY": 895.7255870525338,
        "targetX": 1846.3769239027058,
        "targetY": 652.8996691422008
      },
      {
        "id": "vueflow__edge-0.c9agnbfq324val-train-0.c9agnbfq324-0.vjnimptozin-0.vjnimptoz",
        "type": "smoothstep",
        "source": "0.c9agnbfq324",
        "target": "0.vjnimptoz",
        "sourceHandle": "val-train-0.c9agnbfq324",
        "targetHandle": "in-0.vjnimptoz",
        "data": {
          "key": "train"
        },
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "#ff5722",
          "strokeWidth": 2
        },
        "sourceX": 1576.9202342842545,
        "sourceY": 747.9963229910772,
        "targetX": 1495.9160041091227,
        "targetY": 825.9342859719363
      },
      {
        "id": "vueflow__edge-0.vjnimptozval-split1-0.vjnimptoz-0.nahx3v1j44val-data-0.nahx3v1j44",
        "type": "smoothstep",
        "source": "0.vjnimptoz",
        "target": "0.nahx3v1j44",
        "sourceHandle": "val-split1-0.vjnimptoz",
        "targetHandle": "val-data-0.nahx3v1j44",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "#ff5722",
          "strokeWidth": 2
        },
        "sourceX": 1542.1160773513102,
        "sourceY": 889.9342859719363,
        "targetX": 1278.4767557900116,
        "targetY": 815.7255870525338
      },
      {
        "id": "vueflow__edge-0.nahx3v1j44out-0.nahx3v1j44-0.8h6rp4foe24in-0.8h6rp4foe24",
        "type": "smoothstep",
        "source": "0.nahx3v1j44",
        "target": "0.8h6rp4foe24",
        "sourceHandle": "out-0.nahx3v1j44",
        "targetHandle": "in-0.8h6rp4foe24",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "teal",
          "strokeWidth": 2
        },
        "sourceX": 1194.4767557900116,
        "sourceY": 927.7255870525338,
        "targetX": 1193.996438765219,
        "targetY": 949.5304408503189
      },
      {
        "id": "vueflow__edge-0.vjnimptozval-split2-0.vjnimptoz-0.8h6rp4foe24val-data-0.8h6rp4foe24",
        "type": "smoothstep",
        "source": "0.vjnimptoz",
        "target": "0.8h6rp4foe24",
        "sourceHandle": "val-split2-0.vjnimptoz",
        "targetHandle": "val-data-0.8h6rp4foe24",
        "data": {},
        "label": "",
        "animated": false,
        "animationSpeed": 0.5,
        "style": {
          "stroke": "#ff5722",
          "strokeWidth": 2
        },
        "sourceX": 1542.1160773513102,
        "sourceY": 929.9342859719363,
        "targetX": 1246.746438765219,
        "targetY": 1013.5304408503189
      }
    ],
    "position": [49.947825270149224, 129.3007301254492],
    "zoom": 0.5,
    "viewport": {
      "x": 49.947825270149224,
      "y": 129.3007301254492,
      "zoom": 0.5
    }
  },
  "unlockNodes": [],
  "steps": [
    {
      "text": "They say winners never quit, but in machine learning, knowing when to quit can be the key to success. In this tutorial, we’ll explore two essential techniques: validation and early stopping. Together, they help your model achieve optimal performance by monitoring its progress and halting training at the right time.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "In the last tutorial, we discussed the issue of overfitting. The question is, how do we prevent it?",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "To tackle overfitting, we need to keep an eye on how well our model is doing. This involves running small tests after each training cycle, or epoch, in a process called validation. Validation gives us an estimate of the test error, much like checking your answers after solving each question on a practice exam.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Let’s add validation to your model. First, we need to split the training data into two parts: one for training and one for validation.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Add a split node to your canvas.",
      "narrator": "LeNet-5",
      "addNodes": [
        {
          "id": "0.07kkpovup2mr",
          "type": "split",
          "data": {},
          "identifier": "split",
          "group_identifier": "dataset"
        }
      ],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": ["split"],
      "unlockNodes": []
    },
    {
      "text": "Great! Now, connect the split1 output of the first split node to the input of the new split node. Then, remove the connection between the first split node and the fit node.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [
        {
          "id": "vueflow__edge-0.vjnimptozval-split1-0.vjnimptoz-0.07kkpovup2mrin-0.07kkpovup2mr",
          "type": "smoothstep",
          "source": "0.vjnimptoz",
          "target": "0.07kkpovup2mr",
          "sourceHandle": "val-split1-0.vjnimptoz",
          "targetHandle": "in-0.07kkpovup2mr",
          "data": {},
          "label": "",
          "animated": false,
          "animationSpeed": 0.5,
          "style": {
            "stroke": "#ff5722",
            "strokeWidth": 2
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [
        {
          "id": "vueflow__edge-0.vjnimptozval-split1-0.vjnimptoz-0.nahx3v1j44val-data-0.nahx3v1j44"
        }
      ],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "In the settings of the new split node, set the ratio to 0.8. This means 80% of the training data will be used for training, and 20% will be used for validation.",
      "narrator": "LeNet-5",
      "addNodes": [
        {
          "id": "0.07kkpovup2mr",
          "data": {
            "ratio": 0.8
          }
        }
      ],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Now connect the split1 output of the new split node to the training input and the split2 output to the validation input of the fit node.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [
        {
          "id": "vueflow__edge-0.07kkpovup2mrval-split1-0.07kkpovup2mr-0.nahx3v1j44val-x-0.nahx3v1j44",
          "type": "smoothstep",
          "source": "0.07kkpovup2mr",
          "target": "0.nahx3v1j44",
          "sourceHandle": "val-split1-0.07kkpovup2mr",
          "targetHandle": "val-data-0.nahx3v1j44",
          "data": {},
          "label": "",
          "animated": false,
          "animationSpeed": 0.5,
          "style": {
            "stroke": "#ff5722",
            "strokeWidth": 2
          }
        },
        {
          "id": "vueflow__edge-0.07kkpovup2mrval-split2-0.07kkpovup2mr-0.nahx3v1j44val-validation_data-0.nahx3v1j44",
          "type": "smoothstep",
          "source": "0.07kkpovup2mr",
          "target": "0.nahx3v1j44",
          "sourceHandle": "val-split2-0.07kkpovup2mr",
          "targetHandle": "val-validation_data-0.nahx3v1j44",
          "data": {},
          "label": "",
          "animated": false,
          "animationSpeed": 0.5,
          "style": {
            "stroke": "#ff5722",
            "strokeWidth": 2
          }
        }
      ],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "Awesome! Your validation setup is complete. Hit the train button and observe the line chart. The chart shows the Mean Absolute Error (MAE) for both the training and validation data.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": [],
      "trainingEnabled": true
    },
    {
      "text": "You’ll observe a common pattern in the graph: while the training MAE keeps decreasing, the validation MAE starts increasing after a certain point. This indicates that the model is starting to overfit. Ideally, training should stop at this point.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "This is where early stopping becomes useful. It’s a technique that stops training when the validation error starts increasing and automatically restores the model to the state where the validation error was at its lowest.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    },
    {
      "text": "How do we enable early stopping? Look for the Early Stopping Patience setting in the fit node. Go ahead and set it to 5. This means training will stop if the validation error doesn’t decrease for 5 consecutive epochs.",
      "narrator": "LeNet-5",
      "addNodes": [
        {
          "id": "0.nahx3v1j44",
          "data": {
            "early_stopping": 5
          }
        }
      ],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": [
        {
          "type": "fit",
          "data": ["early_stopping"]
        }
      ]
    },
    {
      "text": "Great! Now hit the train button again and watch the magic happen. The training will stop automatically when early stopping is triggered.",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": [],
      "trainingEnabled": true
    },
    {
      "text": "Congratulations! By using early stopping, you’ve reduced overfitting and decreased training time. This is a powerful technique that helps achieve better results in less time. Keep experimenting, and stay tuned for more exciting tutorials!",
      "narrator": "LeNet-5",
      "addNodes": [],
      "addEdges": [],
      "removeNodes": [],
      "removeEdges": [],
      "highlightNodeTypes": [],
      "unlockNodes": []
    }
  ]
}
